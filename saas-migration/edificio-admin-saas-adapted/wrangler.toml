name = "edificio-admin-saas-adapted"
main = "src/index.js"
compatibility_date = "2024-11-12"
assets = { directory = "./public", binding = "ASSETS" }

# D1 Database - NOTA: Actualizar con tu database_id después de crear la DB
# Ejecutar: wrangler d1 create edificio_admin_db
[[d1_databases]]
binding = "DB"
database_name = "edificio_admin_db"
database_id = "807560dd-74a4-43e4-81cb-f3486506fbfe"

# KV Namespace para sesiones - NOTA: Actualizar IDs después de crear
# Ejecutar: wrangler kv:namespace create SESSIONS
[[kv_namespaces]]
binding = "SESSIONS"
id = "08cfc405ae2640a59169aaaa21377c98"


# KV Namespace para caché
# Ejecutar: wrangler kv:namespace create CACHE
[[kv_namespaces]]
binding = "CACHE"
id = "9da6e4e22f534afc8ff4485831eb904e"

# KV Namespace para rate limiting
# Ejecutar: wrangler kv:namespace create RATE_LIMIT
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "5e4633c8e64c49989668f699ad601c16"

# KV Namespace para códigos OTP
# Ejecutar: wrangler kv:namespace create OTP_CODES
[[kv_namespaces]]
binding = "OTP_CODES"
id = "6f3e1a8d74bd405eb8bd891fe82be35d"

# R2 Storage para archivos (uploads)
# Ejecutar: wrangler r2 bucket create edificio-admin-uploads
[[r2_buckets]]
binding = "UPLOADS"
bucket_name = "edificio-admin-uploads"

# Variables de entorno
[vars]
ENVIRONMENT = "production"
JWT_SECRET = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NjU2NTQyMjl9.q5GaiRMArOEz-V5QS0293GLdNPd8q_iciOZv1jvgTil2-tFsgwv2D1B0L0tfLhOrs3FKJzbyEzVi8Lrlo8bb9kyzafXtg1RUjTnRgMJKNqgr3e_tfPIGqJXf0njKJshastqS1x-v6KSzYTYEG49kJ8ZzgPpY_0vxyhy_s8udtO4VzX8X4E4xFtgiucw39LpqrzDEIBv6Ngm2XIDPRBxLh2Uxv8WlYpAy9onjexShSDlvJqqYkNddhEPo3uiTzTTrNKl8b_YcK53pGEPoIQwpbJ9WqueU6Rn4nc56FdjMlCi-_46l7JRg3Nq3W0cRDv_1hOrjGhhHIhLcMKNGRZarcA"
EMAIL_SENDER = "notificaciones@edificio-admin.com"
APP_URL = "https://edificio-admin-saas-adapted.sebastianvernis.workers.dev/"

# Configuración SMTP (opcional - MailChannels es gratuito en Workers)
# Si quieres usar SMTP tradicional, configura estas variables en .dev.vars
# SMTP_HOST = "smtp.gmail.com"
# SMTP_PORT = "587"
# SMTP_USER = "tu-email@gmail.com"
# SMTP_PASS = "tu-password-o-app-password"
# SMTP_FROM = "noreply@edificio-admin.com"
# SMTP_SECURE = "false"

# Para usar API SMTP alternativa (SendGrid, Mailgun, etc.)
# SMTP_API_URL = "https://api.sendgrid.com/v3/mail/send"
# SMTP_API_KEY = "tu-api-key"

# Configuración específica para producción
[env.production]
name = "edificio-admin-saas-adapted-prod"
vars = { ENVIRONMENT = "production" }

# Scheduled events (cron jobs)
[triggers]
crons = [
  "0 0 L * *"  # Último día del mes a medianoche (cierre automático)
]
